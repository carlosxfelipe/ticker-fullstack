{% extends 'base.html' %}
{% load static %}
{% now "U" as cache_bust %}

{% block title %}Portfolio{% endblock %}

{% block content %}
  <h1>Bem-vindo ao Portfolio!</h1>
  <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; align-items: center;">
    <a href="/manager">Ir para Gerenciador de Ativos</a>
    <span aria-hidden="true">|</span>
    <a href="/settings">Configurações</a>
  </div>
  <div style="max-width: 600px; margin: auto;">
    <h3 style="text-align:center;">Gráfico Rosquinha</h3>
    <canvas id="doughnutChart"></canvas>
    <h3 style="text-align:center; margin-top:2rem;">Gráfico Barra</h3>
    <canvas id="barChart"></canvas>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  <script src="{% static 'js/portfolio.js' %}?v={{ cache_bust }}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const labels = {{ labels|safe }};
      const values = {{ values|safe }};
      if (typeof initPortfolioChart === 'function') {
        // Rosquinha
        initPortfolioChart(labels, values, 'doughnut', 'doughnutChart');
        // Barra
        initPortfolioChart(labels, values, 'bar', 'barChart');
      }
    });
  </script>
{% endblock %}
